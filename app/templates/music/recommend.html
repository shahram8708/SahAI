{% extends "base.html" %}
{% set page_title = "Mood-to-Music" %}
{% block content %}
<main id="main-content" class="container py-4 fade-in">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h4 m-0"><i class="bi bi-music-note-beamed text-success me-2"></i>Mood-to-Music</h1>
  <form method="POST" class="d-flex gap-2">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <div class="btn-group" role="group" aria-label="Select mood">
        {% for m in moods %}
          <button name="mood" value="{{ m }}" class="btn btn-outline-success btn-sm rounded-pill {% if m==chosen_mood %}active{% endif %}">
            {{ m }}
          </button>
        {% endfor %}
      </div>
    </form>
  </div>

  {% if detected_mood %}
    <div class="alert alert-info rounded-3">
      <i class="bi bi-eye me-2"></i>Detected mood from your latest entries: <strong>{{ detected_mood }}</strong>
      <span class="ms-2 text-muted">Change with chips above.</span>
    </div>
  {% else %}
    <div class="alert alert-secondary rounded-3">
      <i class="bi bi-info-circle me-2"></i>No recent mood found â€” pick one above to personalize.
    </div>
  {% endif %}

  {% if error %}
    <div class="alert alert-warning rounded-3"><i class="bi bi-exclamation-triangle me-2"></i>{{ error }}</div>
  {% endif %}

  {% if payload %}
    <div class="mb-3">
      <p class="lead">{{ payload.rationale }}</p>
    </div>
    <div class="row g-3">
      {% for p in payload.playlists %}
        {% include "music/_playlist_card.html" %}
      {% endfor %}
    </div>
  {% else %}
    <div class="text-center text-muted py-5">
      <i class="bi bi-music-note-list fs-1 d-block mb-2"></i>
      <p>Select a mood above to load supportive playlists.</p>
    </div>
  {% endif %}

  <p class="small text-muted mt-3">Music suggestions are supportive. Choose what feels good for you ðŸ’š</p>
</main>
{% endblock %}
